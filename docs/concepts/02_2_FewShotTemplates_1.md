# LangChain Few-shot 프롬프트 최적화 개념

LangChain에서 Few-shot 프롬프트를 효율적으로 활용하는 방법은 크게 세 가지 개념으로 나눌 수 있음

## 1. Few-shot 프롬프트와 Example Selector 결합

**핵심**: 예시가 많을 때, 모든 예시를 사용하는 대신 `사용자의 질문과 가장 유사한 예시`만 선택하여 프롬프트에 포함하는 방법

* **동작 방식**: `SemanticSimilarityExampleSelector` 같은 클래스가 `벡터 유사도 검색`을 수행합니다. 사용자의 질문과 의미적으로 가장 가까운 예시를 찾아 프롬프트에 넣음
* **목표**: 불필요한 예시를 제외하여 프롬프트의 길이를 최적화하고, 모델의 응답 정확도를 높임
* **결과**: 프롬프트에 모든 예시가 아닌, 선택된 소수의 예시만 포함되어 모델에 전달

## 2. Example Selector의 검색 문제 해결 (커스텀 클래스 활용)

**핵심**: 기본 `Example Selector`가 부정확한 예시를 선택하는 문제를 해결하기 위해, `더 정교한 유사도 검색 로직`을 적용하는 방법입니다.

* **문제점**: 기본 `Example Selector`는 예시 전체를 기준으로 유사도를 계산합니다. 이 때문에 "회의록 작성" 같은 질문 의도(`instruction`)만으로는 **문장 교정** 같은 엉뚱한 예시 선택 가능성 있음
* **해결책**: `CustomExampleSelector` 같은 커스텀 클래스를 만듭니다. 이 클래스는 `instruction`과 `input`을 함께 고려하여 유사도를 계산하므로, 질문의 의도에 맞는 예시를 정확하게 찾아냄
* **결과**: 사용자의 질문 의도와 내용을 모두 고려하여, `회의록 작성` 질문에는 `회의록 작성` 예시가 올바르게 선택됨

---

## 3. 멀티태스크 Few-shot 프롬프트

**핵심**: 하나의 프롬프트에 여러 가지 다른 종류의 작업(회의록, 요약, 문장 교정 등)에 대한 예시를 모두 포함하는 방법

* **동작 방식**: `FewShotPromptTemplate`에 다양한 작업 유형의 예시들을 모두 담아둠
* **목표**: 모델이 여러 작업을 수행할 수 있도록 훈련시키고, 사용자의 입력에 따라 적절한 작업 유형을 스스로 판단하여 수행하도록 유도하는 것
* **결과**: `Example Selector`가 올바른 예시를 선택해 주면, 모델은 해당 예시를 참고하여 요청된 작업을 정확하게 수행합니다. 예를 들어, '문장 교정' 요청이 들어오면 '문장 교정' 예시를 참고하여 답변을 생성

---

이 세 가지 개념은 Few-shot 프롬프트를 단순히 사용하는 것을 넘어, 복잡한 실제 상황에 맞춰 프롬프트를 최적화하고 모델의 활용도를 극대화하는 데 중요한 기술

---